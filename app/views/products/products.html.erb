<h1>Our Products</h1>

<div class="products-grid">
  <% @products.each do |product| %>
    <div class="product-card">
      <img src="<%= product.productImage %>" alt="<%= product.productName %>" />
      <h3><%= product.productName %></h3>
      <h4>Category: <%= product.productCategory %></h4>
      <p>KSh <%= product.productPrice %></p>
      <button class="view-item-btn"
              data-name="<%= product.productName %>"
              data-category="<%= product.productCategory %>"
              data-description="<%= product.productDescription %>"
              data-price="<%= product.productPrice %>"
              data-image="<%= product.productImage %>">
        View Item
      </button>
    </div>
  <% end %>
</div>

<!-- Modal -->
<div id="productModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <div class="modal-body">
      <div class="modal-image">
        <img id="modalProductImage" src="" alt="Product image" />
      </div>
      <div class="modal-details">
        <h2 id="modalProductName"></h2>
        <p><strong>Category:</strong> <span id="modalProductCategory"></span></p>
        <p id="modalProductDescription"></p>
        <p><strong>Price:</strong> KSh <span id="modalProductPrice"></span></p>
        <div class="quantity-box">
          <label for="quantityInput">Quantity:</label>
          <input type="number" id="quantityInput" value="1" min="1" />
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .products-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
  }

  .product-card {
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 10px;
    text-align: center;
    box-shadow: 0 0 5px rgba(0,0,0,0.1);
  }

  .product-card img {
    width: 100%;
    height: 200px;
    object-fit: cover;
  }

  .view-item-btn {
    margin-top: 10px;
    background-color: #5a00cc;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
  }

  .modal {
    display: none;
    position: fixed;
    z-index: 10;
    left: 0; top: 0;
    width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.5);
  }

  .modal-content {
    background: white;
    margin: 5% auto;
    padding: 20px;
    border-radius: 10px;
    width: 60%;
    max-width: 800px;
  }

  .modal-body {
    display: flex;
    gap: 20px;
  }

  .modal-image img {
    width: 300px;
    height: 300px;
    object-fit: cover;
    border-radius: 8px;
  }

  .modal-details {
    flex: 1;
  }

  .close {
    float: right;
    font-size: 1.5em;
    cursor: pointer;
  }
</style>

<script>
  document.querySelectorAll(".view-item-btn").forEach(button => {
    button.addEventListener("click", () => {
      document.getElementById("productModal").style.display = "block";
      document.getElementById("modalProductName").textContent = button.dataset.name;
      document.getElementById("modalProductCategory").textContent = button.dataset.category;
      document.getElementById("modalProductDescription").textContent = button.dataset.description;
      document.getElementById("modalProductPrice").textContent = button.dataset.price;
      document.getElementById("modalProductImage").src = button.dataset.image;
    });
  });

  document.querySelector(".close").addEventListener("click", () => {
    document.getElementById("productModal").style.display = "none";
  });

  window.addEventListener("click", (event) => {
    if (event.target === document.getElementById("productModal")) {
      document.getElementById("productModal").style.display = "none";
    }
  });
</script>
